!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.LocalStorageCache=t()}(this,function(){var e={add:function(e,t,o){"object"==typeof vallue&&(t=JSON.stringify(t)),o=this._getExp(o);var a={data:t,expired:o,time:+new Date};localStorage.setItem(e,JSON.stringify(a))},get:function(e,t){var o=JSON.parse(localStorage.getItem(e)),a=$.Deferred();if(o.expired>0){var r=+new Date;r>o.expired?t?t().fail(function(){a.resolve(o.data)}):a.resolve(null):a.resolve(o.data)}else a.resolve(o.data);return a.promise()},remove:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()},update:function(e,t,o){"object"==typeof vallue&&(t=JSON.stringify(t)),o=this._getExp(o);var a=JSON.parse(localStorage.getItem(e));null!=a&&("undefined"==typeof o||""==o?o=a.expired:null);var r={data:t,expired:o,time:+new Date};localStorage.setItem(e,JSON.stringify(r))},_getExp:function(e){if(0==e){var t=this;window.onbeforeunload=function(){t.remove(key)}}else if("number"!=typeof e&&isNaN(Number(e)))"object"==typeof e&&(e=e.getTime()||-1);else{var o=+new Date;e=o+1e3*e}return e}};return e});